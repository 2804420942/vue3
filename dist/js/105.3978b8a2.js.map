{"version":3,"file":"js/105.3978b8a2.js","mappings":"kKAEA,SAASA,EAAWC,GAClB,IAAIC,EACJ,MAAMC,EAASC,KAAKC,YAAYC,MAC5BH,QAA8B,IAApBA,EAAOI,WACnBJ,EAAOK,cAAcP,QAAUA,GACjC,IAAK,MAAMQ,KAASL,KAAKM,OAAOC,cACyC,KAAjC,OAAhCT,EAAKO,EAAMG,SAASC,cAAmB,EAASX,EAAGK,YACvDE,EAAMR,QAAUA,GAEtB,SAASa,IACP,GAAIV,KAAKW,KACP,OACF,MAAMC,EAAMZ,KAAKM,OACjBO,EAAAA,GAAAA,IAAiBD,GACjBZ,KAAKc,MAAK,IAAMD,EAAAA,GAAAA,UAAoBD,KACpCZ,KAAKe,cAAa,KAChB,MAAMhB,EAASC,KAAKC,YAAYC,MAChC,IAAKH,EACH,OACF,IAAIiB,GAAc,EAClBpB,EAAWqB,KAAKjB,MAAOgB,GACvB,IAAIE,GAAQ,EACZ,MAAMC,GAASC,EAAAA,EAAAA,KAAmB,KAChC,MAAMC,EAASrB,KAAKI,cAAckB,iBAAiBC,EAAAA,IAC7CC,EAASxB,KAAKyB,SAASH,iBAAiBI,EAAAA,IACxCC,EAAOH,EAAOI,WAAWP,GAC/BT,EAAIiB,SAASC,KAAKN,EAAQN,EAAQ,EAAI,IACtC,MAAMa,EAAQb,EAAQ,EAAIN,EAAIiB,SAASD,WAAWP,GAAUM,EAC5Df,EAAIiB,SAASG,YAAYX,EAAQG,EAAQO,GACzCnB,EAAIqB,WAAWC,KAAKlC,KAAKyB,SAASU,mBAAmBF,EAAAA,KACrD,MAAMG,IAAWC,EAAAA,EAAAA,OAA4BN,EAAQ,IACrDK,IAAapB,GAAepB,EAAWqB,KAAKjB,MAAOoC,GACnDpB,EAAcoB,EACdlB,GAAQ,KAEV,MAAO,KACLC,EAAOmB,YAER,CAACtC,KAAKC,YAAYC","sources":["webpack://vue3/./node_modules/lingo3d-vue/dist/enableBVHCamera.js"],"sourcesContent":["import { bn as bvhCameraSet, bo as onBeforeCameraLoop, b7 as vector3, b8 as vector3_, bp as quaternion, b1 as getEditorActive } from \"./index.js\";\nimport \"vue\";\nfunction setVisible(visible) {\n  var _a;\n  const target = this.targetState.get();\n  if (target && target._visible === void 0)\n    target.outerObject3d.visible = visible;\n  for (const child of this.camera.children)\n    if (((_a = child.userData.manager) == null ? void 0 : _a._visible) === void 0)\n      child.visible = visible;\n}\nfunction enableBVHCamera() {\n  if (this.done)\n    return;\n  const cam = this.camera;\n  bvhCameraSet.add(cam);\n  this.then(() => bvhCameraSet.delete(cam));\n  this.createEffect(() => {\n    const target = this.targetState.get();\n    if (!target)\n      return;\n    let tooCloseOld = true;\n    setVisible.call(this, !tooCloseOld);\n    let first = true;\n    const handle = onBeforeCameraLoop(() => {\n      const origin = this.outerObject3d.getWorldPosition(vector3);\n      const camPos = this.object3d.getWorldPosition(vector3_);\n      const dist = camPos.distanceTo(origin);\n      cam.position.lerp(camPos, first ? 1 : 0.1);\n      const ratio = first ? 1 : cam.position.distanceTo(origin) / dist;\n      cam.position.lerpVectors(origin, camPos, ratio);\n      cam.quaternion.copy(this.object3d.getWorldQuaternion(quaternion));\n      const tooClose = getEditorActive() ? false : ratio < 0.35;\n      tooClose !== tooCloseOld && setVisible.call(this, !tooClose);\n      tooCloseOld = tooClose;\n      first = false;\n    });\n    return () => {\n      handle.cancel();\n    };\n  }, [this.targetState.get]);\n}\nexport { enableBVHCamera as default };\n"],"names":["setVisible","visible","_a","target","this","targetState","get","_visible","outerObject3d","child","camera","children","userData","manager","enableBVHCamera","done","cam","bvhCameraSet","then","createEffect","tooCloseOld","call","first","handle","onBeforeCameraLoop","origin","getWorldPosition","vector3","camPos","object3d","vector3_","dist","distanceTo","position","lerp","ratio","lerpVectors","quaternion","copy","getWorldQuaternion","tooClose","getEditorActive","cancel"],"sourceRoot":""}